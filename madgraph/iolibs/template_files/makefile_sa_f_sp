include ../../Source/make_opts
SHELL = /bin/bash
LIBDIR = ../../lib/
PROG   = check
PROG_SPLITORDERS = check_sa_born_splitOrders
LINKLIBS =  -L../../lib/ -ldhelas -lmodel
LIBS = $(LIBDIR)libdhelas.$(libext) $(LIBDIR)libmodel.$(libext)
PROCESS=  matrix.o
CHECK_SA=  check_sa.o
CHECK_SA_SPLITORDERS=  check_sa_born_splitOrders.o
 
$(PROG): $(PROCESS) $(CHECK_SA) makefile $(LIBS)
	$(FC) $(FFLAGS) -o $(PROG) $(PROCESS) $(CHECK_SA) $(LINKLIBS)

$(PROG_SPLITORDERS): $(PROCESS) $(CHECK_SA_SPLITORDERS) makefile $(LIBS)
	$(FC) $(FFLAGS) -o $(PROG) $(PROCESS) $(CHECK_SA_SPLITORDERS) $(LINKLIBS)

driver.f: nexternal.inc pmass.inc ngraphs.inc coupl.inc

# For python linking (require f2py part of numpy)
matrix2py.so: matrix.f makefile $(LIBS)
	touch __init__.py
	@ if [ -f `which f2py` ]; then \
		f2py $(LINKLIBS) -c  matrix.f -m matrix2py;\
	  else \
		if [ -f `which f2py-2.7` ]; then \
			f2py-2.7 $(LINKLIBS) -c  matrix.f -m matrix2py;\
		else \
			f2py-2.6 $(LINKLIBS) -c  matrix.f -m matrix2py;\
		fi; \
	  fi
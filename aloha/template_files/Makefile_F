# ----------------------------------------------------------------------------
#
# Makefile for DHELAS 4.0 library
# Feb. 28, 2001
#
# ----------------------------------------------------------------------------
#
# Use a TAB to precede shell commands (e.g., f90, ar, etc).
# Note: this Makefile uses features that *may not*
# be supported by make utilities other than GNU make.
#
# ----------------------------------------------------------------------------

FC = g77

FFLAGS        = -O -I.

LD	      = ld

DEST	      = ../

EXTHDRS	      =

HDRS	      =

INSTALL	      = /etc/install

LIBRARY	      = ../libdhelas3.a

MAKEFILE      = Makefile

BASIC_OBJS = aloha_functions.o

include ./aloha_file.inc

PRINT	      = pr

SHELL	      = /bin/sh

SYSHDRS	      =

MFLAGS        = -e

#.F.o:
%.o : %.F
	$(FC) $(FFLAGS) -c $<

%.o : %.f
	$(FC) $(FFLAGS) -c $<

all:		$(LIBRARY)

helas:
		-rm -f *.o
		export FFLAGS='-O +cpp' && \
		export LIBRARY=libdhelas3.a && \
		$(MAKE) $(MFLAGS)

helas_check:
		-rm -f *.o
		export FFLAGS='-O +cpp -DHELAS_CHECK' && \
		export LIBRARY=libdhelas3_check.a && \
		$(MAKE) $(MFLAGS)

install-helas:
		export LIBRARY=libdhelas3.a && \
		$(MAKE) $(MFLAGS) install	

install-helas_check:
		export LIBRARY=libdhelas3.a && \
		$(MAKE) $(MFLAGS) install	

$(LIBRARY):	$(BASIC_OBJS) $(ALOHARoutine)
		@echo  "Loading $(LIBRARY) ... "
		@ar cru $(LIBRARY) $(BASIC_OBJS) $(ALOHARoutine)
		@echo "done"

clean:;		@rm -f $(BASIC_OBJS) $(ALOHARoutine) core

clobber:;	@rm -f $(OBJS) $(ALOHARoutine) $(LIBRARY) core tags

install:	$(LIBRARY)
	        @echo Installing $(LIBRARY) in $(DEST)
	        @if [ $(DEST) != . ]; then \
	        (rm -f $(DEST)/$(LIBRARY); $(INSTALL) -f $(DEST) $(LIBRARY)); fi

$(DEST)/$(LIBRARY): $(SRCS) $(HDRS) $(EXTHDRS)
	        @$(MAKE) -f $(MAKEFILE) ROOT=$(ROOT) DEST=$(DEST) install

include ../../Source/make_opts

CC    = g++

LIBDIR = ../../lib/
BINDIR = ../../bin/

FASTJET_CONFIG = fastjet-config
CXXFLAGS += $(shell $(FASTJET_CONFIG) --cxxflags)
FJLIBS += $(shell $(FASTJET_CONFIG) --libs --plugins ) -lstdc++
#FJLIBS += $(shell $(FASTJET_CONFIG) --libs --plugins )
#FJLIBS=

LINKLIBS =  -L../../lib/ -ldhelas -ldsample_fks -lmodel -lgeneric -lpdf
LIBS = $(LIBDIR)libdhelas.a $(LIBDIR)libdsample_fks.a $(LIBDIR)libgeneric.a $(LIBDIR)libpdf.a $(LIBDIR)libmodel.a

# Files for all executables
FILES= myamp.o auto_dsig.o genps_fks.o matrix.o setcuts.o cluster.o reweight.o initcluster.o setscales.o \
         born.o sborn_sf.o $(patsubst %.f,%.o,$(wildcard b_sf_???.f)) fks_Sij.o trapfpe.o fastjetfortran_madfks.o \
         ktclusdble.o fks_singular.o montecarlocounter.o mirror.o

# Files needed for vegas, mint & mintMC
RUN= $(FILES) unwgt.o cuts.o add_write_info.o LesHouches.o madfks_dbook.o madfks_plot.o

# Files for vegas
VEGAS= $(RUN) driver_vegas.o vegas2.o

# Files for mint
MINT= $(RUN) mint-integrator2.o driver_mint.o

# Files for mintMC
MINTMC= $(RUN) mint-integrator2.o driver_mintMC.o write_event.o

# Files for tests
TEST= $(FILES) LesHouchesDummy.o cuts.o

# Files for gensym
SYM= $(FILES) LesHouchesDummy.o symmetry_fks_v3.o

# Files for link_fks
LINK= $(TEST) link_fks.o

# Files for genint_fks
INTEGRATE= genint_fks.o

%.o : %.f
	$(F77) $(FFLAGS) -c $<
%.o : %.for
	$(F77) $(FFLAGS) -c $<
%.o: %.c
	$(CC) -g -c $^
%.o: %.cc
	$(CC) -g -c $(CXXFLAGS) $^

genint_fks: $(INTEGRATE)
	$(F77) $(FFLAGS) -o genint_fks $(INTEGRATE)

link_fks: $(LINK)
	$(F77) $(FFLAGS) -o link_fks $(LINK) $(LINKLIBS) $(FJLIBS)
	rm fks_singular.o genps_fks.o

gensym: $(SYM)
	$(F77) $(FFLAGS) -o gensym $(SYM) $(LINKLIBS) $(FJLIBS)
	rm fks_singular.o

test_Sij: symmetry_fks_test_Sij.o $(TEST)
	$(F77) $(FFLAGS) -o test_Sij symmetry_fks_test_Sij.o $(TEST) $(LINKLIBS) $(FJLIBS)

test_ME: symmetry_fks_test_ME.o $(TEST)
	$(F77) $(FFLAGS) -o test_ME symmetry_fks_test_ME.o $(TEST) $(LINKLIBS) $(FJLIBS)

test_MC: symmetry_fks_test_MC.o $(TEST) 
	$(F77) $(FFLAGS) -o test_MC symmetry_fks_test_MC.o $(TEST) $(LINKLIBS) $(FJLIBS)

madevent_vegas: $(VEGAS)  makefile $(LIBS)
	$(F77) $(FFLAGS) -o madevent_vegas $(VEGAS) $(LINKLIBS) $(FJLIBS)

madevent_mint: $(MINT)  makefile $(LIBS)
	$(F77) $(FFLAGS) -o madevent_mint $(MINT) $(LINKLIBS) $(FJLIBS)

madevent_mintMC: $(MINTMC)  makefile $(LIBS)
	$(F77) $(FFLAGS) -o madevent_mintMC $(MINTMC) $(LINKLIBS) $(FJLIBS)
